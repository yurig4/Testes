<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Registro de Aulas Pr√°ticas</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    .container {
      background: #fff;
      max-width: 700px;
      margin: auto;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    h2 {
      color: #333;
      text-align: center;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      margin-top: 25px;
      padding: 12px;
      background-color: #4285f4;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background-color: #3367d6;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Registro de Aulas Pr√°ticas</h2>
    <div class="form-container">
      <form id="aulasPraticasForm">
        <label>Nome do Professor:</label>
        <input type="text" name="nomeProfessor" required>

        <label>Email:</label>
        <input type="email" name="emailProfessor" required>

        <label>Disciplina:</label>
        <input type="text" name="disciplina" required>

        <label>Turma:</label>
        <input type="text" name="turma" required>

        <label>Assunto da Aula:</label>
        <input type="text" name="assunto" required>

        <label>Data da Aula:</label>
        <input type="date" name="data" required>

        <label>Hor√°rio de In√≠cio:</label>
        <input type="time" name="horarioInicio" required>

        <label>Hor√°rio de T√©rmino:</label>
        <input type="time" name="horarioFim" required>

        <label>N√∫mero de Alunos:</label>
        <input type="number" name="numAlunos" required>

        <label>N√∫mero de Grupos:</label>
        <input type="number" name="numGrupos" required>

        <label>Laborat√≥rio:</label>
        <div>
          <input type="checkbox" name="laboratorio" value="Did√°tico"> Did√°tico
          <input type="checkbox" name="laboratorio" value="Agronomia"> Agronomia
          <input type="checkbox" name="laboratorio" value="Anal√≠tica"> Anal√≠tica
        </div>

        <label>Vidrarias por Grupo:</label>
        <textarea name="vidrariasGrupo" required></textarea>

        <label>Vidrarias Comuns:</label>
        <textarea name="vidrariasComuns"></textarea>

        <label>Solu√ß√µes:</label>
        <textarea name="solucoes"></textarea>

        <label>Reagentes:</label>
        <textarea name="reagentes"></textarea>

        <label>Equipamentos:</label>
        <textarea name="equipamentos"></textarea>

        <label>Observa√ß√µes:</label>
        <textarea name="observacoes"></textarea>

        <button type="submit">Enviar Registro</button>
      </form>
    </div>
  </div>

  <script>
    document.getElementById('aulasPraticasForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const dados = {};
      formData.forEach((value, key) => {
        if (dados[key]) {
          if (Array.isArray(dados[key])) {
            dados[key].push(value);
          } else {
            dados[key] = [dados[key], value];
          }
        } else {
          dados[key] = value;
        }
      });

      // Verifica laborat√≥rios
      const labs = Array.from(document.querySelectorAll('input[name="laboratorio"]:checked')).map(el => el.value);
      if (labs.length === 0) {
        alert('Selecione pelo menos um laborat√≥rio.');
        return;
      }
      dados.laboratorio = labs;

      // Valida 48h
      const hoje = new Date();
      const dataSelecionada = new Date(dados.data);
      const prazoMinimo = new Date(hoje);
      prazoMinimo.setDate(hoje.getDate() + 2);
      if (dataSelecionada < prazoMinimo) {
        alert("O prazo m√≠nimo para agendamento √© de 48 horas.");
        return;
      }

      const btn = form.querySelector('button');
      btn.disabled = true;
      btn.textContent = "Enviando...";

      fetch('https://script.google.com/macros/s/AKfycbzmnwPGsNti7vdouZlY_bPK0dKbFGvD-zXt9ZRtXbL7nNEMbr8iNzbKFriMqh6SQcHZ/exec', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(dados)
      })
      .then(() => {
        document.querySelector('.form-container').innerHTML = `
          <h3>‚úÖ Agendamento realizado com sucesso!</h3>
          <p>Voc√™ receber√° um e-mail de confirma√ß√£o em breve.</p>
          <button onclick="abrirUpload()">üìé Enviar Roteiro</button>
          <button onclick="window.location.reload()">‚ûï Novo Agendamento</button>
        `;
      })
      .catch(err => {
        alert("Erro ao enviar. Tente novamente.");
        btn.disabled = false;
        btn.textContent = "Enviar Registro";
      });
    });

    function abrirUpload() {
      window.open(
        'https://script.google.com/macros/s/AKfycbzmnwPGsNti7vdouZlY_bPK0dKbFGvD-zXt9ZRtXbL7nNEMbr8iNzbKFriMqh6SQcHZ/exec?view=upload',
        'uploadJanela',
        'width=500,height=400'
      );
    }
  </script>
</body>
</html>
